{% extends "base.html" %}

{% block title %}Job Board - Find Your Next Opportunity{% endblock %}

{% block content %}
<div class="space-y-8">
    <!-- Hero section -->
    <div class="text-center">
        <h1 class="text-4xl font-bold text-gray-900 mb-4">Find Your Next Opportunity</h1>
        <p class="text-xl text-gray-600 mb-8">Discover amazing jobs from top companies</p>
        
        <!-- Employer CTA -->
        <div class="mt-8 flex justify-center space-x-4">
            <a href="/employer/register" 
               class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700">
                Post a Job
            </a>
            <a href="/employer/login" 
               class="inline-flex items-center px-6 py-3 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                Employer Login
            </a>
        </div>
    </div>

    <!-- Search and filters -->
    <div class="bg-white rounded-lg shadow-sm border p-6">
        <form hx-get="/search" hx-target="#job-results" hx-trigger="submit, keyup changed delay:500ms from:input" hx-indicator="#search-indicator" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <!-- Search input -->
                <div class="md:col-span-2">
                    <label for="q" class="block text-sm font-medium text-gray-700 mb-1">Search Jobs</label>
                    <input 
                        type="text" 
                        id="q" 
                        name="q" 
                        value="{{ search_query or '' }}"
                        placeholder="Search by title, skills, or keywords..."
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                </div>
                
                <!-- Category filter -->
                <div>
                    <label for="category" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                    <select 
                        id="category" 
                        name="category" 
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                        <option value="">All Categories</option>
                        {% for category in categories %}
                        <option value="{{ category.slug }}" {% if selected_category == category.slug %}selected{% endif %}>
                            {{ category.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Tags filter -->
                <div>
                    <label for="tags" class="block text-sm font-medium text-gray-700 mb-1">Tags</label>
                    <input 
                        type="text" 
                        id="tags" 
                        name="tags" 
                        value="{{ selected_tags or '' }}"
                        placeholder="flutter, python, remote..."
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                </div>
            </div>
            
            <!-- Submit button -->
            <div class="flex justify-end">
                <button 
                    type="submit" 
                    class="px-6 py-2 bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
                >
                    Search Jobs
                </button>
            </div>
        </form>
    </div>

    <!-- Search indicator -->
    <div id="search-indicator" class="htmx-indicator text-center py-4">
        <div class="inline-flex items-center px-4 py-2 bg-blue-100 text-blue-800 rounded-md">
            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-blue-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Searching jobs...
        </div>
    </div>

    <!-- Job results -->
    <div id="job-results" class="space-y-6">
        {% if jobs %}
            <div class="text-sm text-gray-600 mb-4">
                Found {{ jobs|length }} job{{ 's' if jobs|length != 1 else '' }}
                {% if search_query or selected_category or selected_tags %}
                    matching your criteria
                {% endif %}
            </div>
            
            <div class="grid gap-6">
                {% for job in jobs %}
                <div class="job-card bg-white rounded-lg shadow-sm border p-6 hover:shadow-md">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h2 class="text-xl font-semibold text-gray-900 mb-2">
                                <a href="/jobs/{{ job.id }}" class="hover:text-blue-600 transition-colors">
                                    {{ job.title }}
                                </a>
                            </h2>
                            
                            <div class="flex items-center text-sm text-gray-600 mb-3">
                                <span class="font-medium">{{ job.employer.name }}</span>
                                {% if job.category %}
                                <span class="mx-2">•</span>
                                <span>{{ job.category.name }}</span>
                                {% endif %}
                                {% if job.published_at %}
                                <span class="mx-2">•</span>
                                <span>{{ job.published_at.strftime('%b %d, %Y') }}</span>
                                {% endif %}
                            </div>
                            
                            <p class="text-gray-700 mb-4 line-clamp-3">{{ job.description[:200] }}{% if job.description|length > 200 %}...{% endif %}</p>
                            
                            {% if job.tags %}
                            <div class="flex flex-wrap gap-2 mb-4">
                                {% for tag in job.tag_list %}
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">{{ tag }}</span>
                                {% endfor %}
                            </div>
                            {% endif %}
                            
                            {% if job.salary_min and job.salary_max %}
                            <div class="text-sm text-gray-600 mb-4">
                                <span class="font-medium">Salary:</span> ${{ "{:,}".format(job.salary_min) }} - ${{ "{:,}".format(job.salary_max) }} {{ job.salary_currency }}
                            </div>
                            {% endif %}
                        </div>
                        
                        <div class="ml-4">
                            <a 
                                href="{{ job.apply_url }}" 
                                target="_blank" 
                                rel="noopener noreferrer"
                                class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors"
                            >
                                Apply Now
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="text-center py-12">
                <div class="text-gray-400 mb-4">
                    <svg class="mx-auto h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
                <h3 class="text-lg font-medium text-gray-900 mb-2">No jobs found</h3>
                <p class="text-gray-600">
                    {% if search_query or selected_category or selected_tags %}
                        Try adjusting your search criteria or browse all jobs.
                    {% else %}
                        No jobs are currently available. Check back soon!
                    {% endif %}
                </p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %} 